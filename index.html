<!DOCTYPE html>
<html>
<head>
  <title>Carte avec Objet Mobile</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <style>
    /* Style personnalisé pour l'icône */
    .custom-marker {
      background-color: #007bff;
      color: white;
      font-size: 14px;
      font-weight: bold;
      border-radius: 5px;
      padding: 5px 10px;
      width: 20px; /* Largeur fixe */
      height: 20px; /* Hauteur fixe */
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
    }
  </style>
</head>
<body>
  <div id="map" style="height: 1200px;"></div>
  <script>
    // Initialiser la carte
    var map = L.map('map').setView([51.040338, 2.306949], 13); // Coordonnées de Paris
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19
    }).addTo(map);
    
    // Ajouter un marqueur avec une icône personnalisée contenant du texte
    var customIcon = L.divIcon({
      className: 'custom-marker',
      html: '11', // Texte à afficher
      iconSize: [20, 20], // Taille de l'icône (optionnel)
      iconAnchor: [10, 10] // Point d'ancrage (optionnel)
    });
    
    // Ajouter un marqueur
    var marker = L.marker([51.040338, 2.306949]).addTo(map);
    // Ajouter un marqueur
    //var marker = L.marker([51.038969, 2.29598]).addTo(map);
    // Ajouter le marqueur à la carte
    L.marker([51.038969, 2.29598], { icon: customIcon }).addTo(map);

    // Ajouter un triangle
    var triangleCoords = [
      [51.029827, 2.318048], // Premier point (sommet du triangle)
      [51.045154, 2.31], // Deuxième point
      [51.05, 2.32], // Troisième point
      [51.029827, 2.318048]  // Retour au premier point pour fermer le polygone
    ];

   // var triangle = L.polygon(triangleCoords, {
    //  color: 'blue', // Couleur des bordures
    //  fillColor: 'blue', // Couleur de remplissage
    //  fillOpacity: 0.5 // Opacité de remplissage
   // }).addTo(map);

    // Dessiner un cône simulé
    var coneCoords = [
      [51.040338, 2.306949], // Sommet du cône
      [51.05, 2.31], // Bord gauche de la base
      [51.05, 2.32], // Bord droit de la base
      [51.040338, 2.306949]  // Retour au sommet
    ];

        // Ajout d'un CircleMarker
    var circle = L.circle([51.040338, 2.306949], {
      radius: 150, // Rayon en pixels
      color: 'red', // Couleur de la bordure
      weight: 4, // Épaisseur de la bordure
      fillColor: 'pink', // Couleur de remplissage
      fillOpacity: 0.6 // Opacité de remplissage
    }).addTo(map);
    // Ajouter un popup au cercle
    circle.bindPopup("C'est un CircleMarker sur la DTD !");

    
    //var cone = L.polygon(coneCoords, {
    //  color: 'red', // Bordures
     // fillColor: 'orange', // Remplissage
     // fillOpacity: 0.6
    //}).addTo(map);

        // Fonction pour générer un quartier de tarte
    function createPieSlice(center, radius, startAngle, endAngle, numPoints = 100) {
      const points = [];
      const toRad = Math.PI / 180;

      // Ajouter le point central (optionnel si vous ne voulez pas un triangle fermé)
      points.push(center);

      // Générer les points du bord de l'arc
      for (let i = startAngle; i <= endAngle; i += (endAngle - startAngle) / numPoints) {
        const lat = center[0] + (radius / 111300) * Math.cos(i * toRad);
        const lng = center[1] + (radius / 111300) * Math.sin(i * toRad) / Math.cos(center[0] * toRad);
        points.push([lat, lng]);
      }

      // Retourner au centre pour fermer le polygone
      points.push(center);

      return points;
    }

    // Coordonnées du centre
    const center = [51.040338, 2.306949]; // Paris

    // Rayon du quartier de tarte (en mètres)
    const radius = 500;

    // Angles de début et de fin (en degrés)
    const startAngle = 15; // 30° à partir du Nord
    const endAngle = 45;  // 120° à partir du Nord

    // Créer un quartier de tarte
    const pieSliceCoords = createPieSlice(center, radius, startAngle, endAngle);

    // Ajouter le quartier de tarte à la carte
    L.polygon(pieSliceCoords, {
      color: 'blue', // Couleur de bordure
      fillColor: 'cyan', // Couleur de remplissage
      fillOpacity: 0.5 // Opacité de remplissage
    }).addTo(map);

    
    // Centrer la vue sur le triangle
    map.fitBounds(triangleCoords.getBounds());
  </script>
</body>
</html>
